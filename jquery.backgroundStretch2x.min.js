/*!
 * jquery.backgroundStrect2x.js v1.0.0
 * (c) 2014, Benoit Asselin contact(at)ab-d.fr
 * MIT Licence
 */
(function(c,n,y){c.fn.backgroundStretch2x=function(b,a){a=c.extend({wait:5E3,fade:2E3,shuffle:!1,centerX:0.5,centerY:0.5,proportional:!0,onLoad:null,onChange:null,onComplete:null,styles:{left:0,top:0,overflow:"hidden",zIndex:-32E3},template:'<div class="background-stretch-2x"></div>'},a);if(!b||!b.length)return this;var p=c(n);return this.each(function(){function q(){var e=r?p:s,b=e.outerWidth(),f=e.outerHeight(),u=b/f;g.css({width:b,height:f}).children().each(function(){var e=c(this),d=0,h=0,g=0,
k=0,d=0;if(a.proportional){var h=e.data("initWidth"),l=e.data("initHeight"),m=e.data("initRatio");u<m?(d=f/l,h=l*d,d=h*m,g=-Math.floor((d-b)*a.centerX)):(d=b/h,d*=h,h=d/m,k=-Math.floor((h-f)*a.centerY))}else d=b,h=f;e.css({left:g,top:k,width:Math.round(d),height:Math.round(h)})})}function l(a,b){if(a){var f=-1!==a.indexOf("-2x."),f=c('<img class="bs-img-'+(f?"2x":"1x")+'"/>');f.data("loaded",!1).load(function(){var a=c(this);a.css({position:"absolute"}).data("loaded",!0).data("initWidth",a.width()).data("initHeight",
a.height()).data("initRatio",a.width()/a.height());isNaN(a.data("initRatio"))?setTimeout(function(){a.trigger("load")},50):(q(),"function"===typeof b&&b())}).error(function(){n.console&&console.log("Error: "+a)}).attr("src",a);g.prepend(f)}}function v(){g.children(".bs-img-1x").remove();if(1<b.length)c.each(b,function(a,b){a&&l(b,w)});else if("function"===typeof a.onLoad)a.onLoad()}function w(){var e=0;g.children().each(function(){c(this).data("loaded")&&e++});if(e>=b.length){if("function"===typeof a.onLoad)a.onLoad();
setInterval(x,a.wait+a.fade)}}function x(){if("function"===typeof a.onChange)a.onChange();g.children().last().animate({opacity:0},a.fade,function(){c(this).prependTo(g).css({opacity:""});if("function"===typeof a.onComplete)a.onComplete()})}var r="body"===this.tagName.toLowerCase(),s=c(this),g=c(c.parseHTML(a.template)).css(a.styles).css({position:r?"fixed":"absolute"}).appendTo(s);a.shuffle&&b.sort(function(){return Math.round(Math.random())-0.5});for(var t=[],k=0;k<b.length;k++)t[k]=b[k].replace("-2x.",
".");p.on("resize orientationchange",q);l(t[0],function(){l(b[0],v)});return this})};c.backgroundStretch2x=function(b,a){c("body").backgroundStretch2x(b,a)}})(jQuery,window);